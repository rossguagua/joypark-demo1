const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/supabase-CAbq-tO9.js","assets/preload-helper-CS1eXPs2.js","assets/analytics-CZ3OqPXu.js"])))=>i.map(i=>d[i]);
import{_ as p}from"./preload-helper-CS1eXPs2.js";let g=[{id:"1",name:"ğŸ» èŠå¤©ç ´å†°ç›²ç›’",category_tag:"drinking-topics",description:"ğŸ”¥ ä¸€ç§’æ‰“ç ´ç¤¾æï¼Œç¬é—´å˜èº«è¯é¢˜ç‹ï¼è®©èšä¼šå—¨èµ·æ¥çš„ç¥å™¨ï¼",features:["å››ç§è¾£åº¦","èšä¼šç ´å†°","éšæœºè¯é¢˜","å¾®é†ºå¿…å¤‡"],players:"2-8äºº",duration:"15-30åˆ†é’Ÿ",is_active:!0,created_at:new Date().toISOString()},{id:"2",name:"ğŸ§  å¿ƒç†æµ‹è¯•æ¸¸æˆ",category_tag:"party-psychology",description:"ğŸ”® çª¥æ¢å†…å¿ƒçš„ç¥ç§˜ä¸–ç•Œï¼Œæ­ç§˜ä½ ä¸çŸ¥é“çš„è‡ªå·±ï¼",features:["ğŸ§© æ€§æ ¼è§£æ","ğŸ­ è¶£å‘³äº’åŠ¨","ğŸ’« æƒŠå–œè¿è¿"],players:"2-6äºº",duration:"20-40åˆ†é’Ÿ",is_active:!0,created_at:new Date().toISOString()},{id:"3",name:"ğŸƒ å¾·å·æ‰‘å…‹",category_tag:"poker",description:"â™ ï¸ ç»å…¸æ‰‘å…‹å·…å³°å¯¹å†³ï¼Œæ™ºæ…§ä¸è¿æ°”çš„å®Œç¾ç¢°æ’ï¼",features:["ğŸ¯ ç­–ç•¥åšå¼ˆ","ğŸ”¥ ç»å…¸ç©æ³•","ğŸ’° åˆºæ¿€å¯¹æˆ˜"],players:"3-8äºº",duration:"30-60åˆ†é’Ÿ",is_active:!0,created_at:new Date().toISOString()}],m=null,r=null,d=null;function f(e){if(e==="drinking-topics")return null;const n={"battle-royale":"battle-royale.png","party-psychology":"party-psychology.png",poker:"poker.png","love-battle":"love-battle.png","moon-night":"moon-night.png","man-di-piao-ling":"man-di-piao-ling.png","kiss-marks":"kiss-marks.png",wisdom:"wisdom.png"}[e];return n?`images/covers/${n}`:(console.warn(`Cover image for ${e} not found in mapping.`),null)}async function y(){if(!m||typeof m!="function"){console.warn("getGames function not available, using fallback data"),c();return}try{console.log("Loading games from database...");const e=performance.now(),t=new Promise((l,i)=>{setTimeout(()=>i(new Error("ç§»åŠ¨ç«¯æ•°æ®åº“è¿æ¥è¶…æ—¶")),15e3)}),n=await Promise.race([m(),t]),o=performance.now()-e;console.log(`Games loaded in ${o.toFixed(2)}ms:`,n),n&&n.length>0?(g=n,c(),document.getElementById("loadingState").style.display="none",console.log("âœ… æ•°æ®åº“æ•°æ®åŠ è½½æˆåŠŸï¼Œå·²æ›¿æ¢fallbackæ•°æ®")):(console.log("âš ï¸ æ•°æ®åº“è¿”å›ç©ºæ•°æ®ï¼Œç»§ç»­ä½¿ç”¨fallbackæ•°æ®"),document.getElementById("loadingState").innerHTML=`
                        <div class="text-center py-2 mb-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg mx-6">
                            <p class="text-yellow-400 text-sm">âš ï¸ æ•°æ®åº“æ•°æ®ä¸ºç©ºï¼Œæ­£åœ¨ä½¿ç”¨æµ‹è¯•æ•°æ®</p>
                        </div>
                    `,c())}catch(e){console.error("Error loading games:",e),console.log("æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œç»§ç»­ä½¿ç”¨fallbackæ•°æ®..."),document.getElementById("loadingState").innerHTML=`
                    <div class="text-center py-4 mb-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg mx-6">
                        <p class="text-yellow-400 text-sm mb-2">âš ï¸ æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œæ­£åœ¨ä½¿ç”¨æµ‹è¯•æ•°æ®</p>
                        <p class="text-gray-400 text-xs">è¯·æ£€æŸ¥Supabaseé…ç½®ååˆ·æ–°é¡µé¢</p>
                        <button onclick="location.reload()" class="bg-yellow-500 text-black px-3 py-1 rounded text-xs mt-2">é‡è¯•è¿æ¥</button>
                    </div>
                `,document.getElementById("loadingState").style.display="block",c()}}function c(){const e=document.getElementById("loadingState"),t=document.getElementById("mainGameSection"),n=document.getElementById("gameGrid");e.innerHTML.includes("æ•°æ®åº“è¿æ¥å¤±è´¥")||(e.style.display="none");const o=g.find(i=>i.category_tag==="drinking-topics");o&&(t.innerHTML=`
                    <div class="game-card" onclick="showGamePreview('${o.category_tag}')">
                        <div class="main-game-card main-game-fallback">
                            <div class="main-game-title">${o.name}</div>
                            <div class="main-game-subtitle">${o.description||""}</div>
                        </div>
                    </div>
                `,t.style.display="block");const l=g.filter(i=>i.category_tag!=="drinking-topics");n.innerHTML=l.map(i=>{const a=f(i.category_tag),s=i.category_tag!=="drinking-topics";return a?`
                    <div class="game-card ${s?"coming-soon":""}" onclick="showGamePreview('${i.category_tag}')">
                        <div class="game-card-content" 
                             style="background-image: url('${a}'); background-size: cover; background-position: center; background-repeat: no-repeat;">
                            <!-- éšè—çš„imgæ ‡ç­¾ç”¨äºæ£€æµ‹åŠ è½½å¤±è´¥ -->
                            <img src="${a}" 
                                 style="display: none;" 
                                 onload="console.log('Image loaded:', '${a}')"
                                 onerror="console.error('Image failed to load:', '${a}'); 
                                         this.parentElement.style.backgroundImage='none'; 
                                         this.parentElement.classList.add('main-game-fallback'); 
                                         this.parentElement.innerHTML='<div style=\\'padding: 16px; text-align: center;\\'><div style=\\'font-size: 16px; font-weight: bold; margin-bottom: 4px;\\'>${i.name||""}</div><div style=\\'font-size: 12px; opacity: 0.8;\\'>${i.description||""}</div></div>';">
                        </div>
                    </div>
                `:`
                        <div class="game-card ${s?"coming-soon":""}" onclick="showGamePreview('${i.category_tag}')">
                            <div class="game-card-content main-game-fallback" style="height: 240px;">
                                <div style="padding: 16px; text-align: center;">
                                    <div style="font-size: 16px; font-weight: bold; margin-bottom: 4px;">${i.name||""}</div>
                                    <div style="font-size: 12px; opacity: 0.8;">${i.description||""}</div>
                                </div>
                            </div>
                        </div>
                    `}).join(""),n.style.display="grid"}window.showGamePreview=function(e){console.log("Showing preview for game:",e),d=e;const t=g.find(a=>a.category_tag===e);if(r&&r("GAME_VIEW",{category_tag:e}),!t){console.error("Game not found:",e),alert("æ¸¸æˆä¿¡æ¯æœªæ‰¾åˆ°ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•");return}document.getElementById("modalTitle").textContent=t.name||"æœªçŸ¥æ¸¸æˆ",document.getElementById("modalDescription").textContent=t.description||"æš‚æ— æè¿°",document.getElementById("modalPlayers").textContent=t.players||"æœªçŸ¥",document.getElementById("modalDuration").textContent=t.duration||"æœªçŸ¥";const n=document.getElementById("modalFeatures");if(n.innerHTML="",t.features&&Array.isArray(t.features)&&t.features.length>0)t.features.forEach(a=>{if(a&&a.trim()){const s=document.createElement("span");s.className="feature-tag",s.textContent=a.trim(),n.appendChild(s)}});else{const a=document.createElement("span");a.className="feature-tag",a.textContent="ä¼‘é—²å¨±ä¹",a.style.opacity="0.6",n.appendChild(a)}const o=document.getElementById("startGameBtn");e==="drinking-topics"?(o.textContent="å¼€å§‹æ¸¸æˆ",o.disabled=!1,o.className="btn-start"):(o.textContent="æ•¬è¯·æœŸå¾…",o.disabled=!0,o.className="btn-start"),document.getElementById("gameModal").classList.add("active"),document.body.style.overflow="hidden"};window.closeModal=function(){document.getElementById("gameModal").classList.remove("active"),d=null,document.body.style.overflow=""};window.startSelectedGame=function(){if(console.log("Starting game:",d),!d){console.error("No game selected");return}r&&r("GAME_START",{category_tag:d}),d==="drinking-topics"?(console.log("Navigating to drinking-game.html"),closeModal(),window.location.href="drinking-game.html"):console.log("Game is coming soon, not navigating")};document.getElementById("gameModal").addEventListener("click",function(e){e.target===this&&closeModal()});document.addEventListener("keydown",function(e){e.key==="Escape"&&closeModal()});document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".game-card").forEach(t=>{t.addEventListener("touchstart",function(){this.style.transform="translateY(-2px) scale(0.98)"}),t.addEventListener("touchend",function(){this.style.transform=""})})});function u(e){const t=document.querySelector(".main-network-status-notification");t&&t.remove();let n,o;if(e==="offline")n="ğŸ”Œ ç¦»çº¿æ¨¡å¼ï¼šä½¿ç”¨æµ‹è¯•æ•°æ®",o="bg-orange-600";else if(e==="online")n="ğŸŒ æ•°æ®å·²æ›´æ–°",o="bg-green-600";else return;const l=document.createElement("div");l.className=`main-network-status-notification fixed top-4 left-4 right-4 ${o} text-white p-3 rounded-lg z-50 text-center text-sm`,l.innerHTML=n,document.body.appendChild(l),setTimeout(()=>{document.body.contains(l)&&(l.style.opacity="0",l.style.transition="opacity 0.5s",setTimeout(()=>{document.body.contains(l)&&document.body.removeChild(l)},500))},2e3)}window.addEventListener("online",()=>{console.log("ä¸»é¡µé¢ï¼šç½‘ç»œè¿æ¥å·²æ¢å¤"),u("online"),setTimeout(()=>{y()},1e3)});window.addEventListener("offline",()=>{console.log("ä¸»é¡µé¢ï¼šç½‘ç»œè¿æ¥å·²æ–­å¼€"),u("offline")});async function v(){console.log("ğŸš€ æ­£åœ¨åˆå§‹åŒ–åº”ç”¨..."),c();try{console.log("ğŸ”„ å°è¯•åŠ è½½Supabaseæ¨¡å—..."),m=(await p(()=>import("./supabase-CAbq-tO9.js"),__vite__mapDeps([0,1]))).getGames,console.log("âœ… Supabaseæ¨¡å—åŠ è½½æˆåŠŸ"),navigator.onLine?(console.log("ğŸŒ ç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œå°è¯•åŠ è½½åœ¨çº¿æ•°æ®"),await y()):(console.log("ğŸ”Œ æ£€æµ‹åˆ°ç¦»çº¿çŠ¶æ€ï¼Œä½¿ç”¨fallbackæ•°æ®"),u("offline"))}catch(e){console.warn("âš ï¸ Supabaseæ¨¡å—åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨fallbackæ•°æ®:",e),m=null,document.getElementById("loadingState").innerHTML=`
                    <div class="text-center py-2 mb-4 bg-yellow-900/20 border border-yellow-500/30 rounded-lg mx-6">
                        <p class="text-yellow-400 text-sm">âš ï¸ æ•°æ®åº“æ¨¡å—æœªåŠ è½½ï¼Œä½¿ç”¨æœ¬åœ°æ•°æ®</p>
                    </div>
                `,document.getElementById("loadingState").style.display="block"}try{r=(await p(()=>import("./analytics-CZ3OqPXu.js"),__vite__mapDeps([2,1]))).trackEvent,console.log("âœ… åˆ†ææ¨¡å—åŠ è½½æˆåŠŸ")}catch(e){console.log("âš ï¸ åˆ†ææ¨¡å—åŠ è½½å¤±è´¥ï¼Œç»§ç»­æ­£å¸¸è¿è¡Œ:",e.message),r=null}console.log("âœ… åº”ç”¨åˆå§‹åŒ–å®Œæˆ")}v();
