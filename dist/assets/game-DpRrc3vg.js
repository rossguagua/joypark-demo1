const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/offline-fallback-CiPykxTm.js","assets/preload-helper-CS1eXPs2.js","assets/analytics-CZ3OqPXu.js"])))=>i.map(i=>d[i]);
import{_ as x}from"./preload-helper-CS1eXPs2.js";let w,h,v,r={},b={},E={},l="mildmode",f=null,T=!1,c={},d=!1,i=["mildmode","ontheedge","intense","surprise"],g=!1;const S={surprise:"ç›²ç›’ Surprise Me",intense:"åŠ éº»åŠ è¾£ Intense",ontheedge:"å¾®è¾£ On the Edge",mildmode:"æ¸…æ±¤ Mild Mode"};function C(e){const t=document.querySelector(".network-status-notification");t&&t.remove();let o,a;if(e==="offline")o="ğŸ”Œ ç¦»çº¿æ¨¡å¼ï¼šä½¿ç”¨æœ¬åœ°æ•°æ®ï¼ŒåŠŸèƒ½æœ‰é™",a="bg-orange-600";else if(e==="online")o="ğŸŒ åœ¨çº¿æ¨¡å¼ï¼šæ­£åœ¨ä½¿ç”¨æœ€æ–°æ•°æ®",a="bg-green-600";else return;const n=document.createElement("div");n.className=`network-status-notification fixed top-4 left-4 right-4 ${a} text-white p-3 rounded-lg z-50 text-center`,n.innerHTML=o,document.body.appendChild(n),setTimeout(()=>{document.body.contains(n)&&(n.style.opacity="0",n.style.transition="opacity 0.5s",setTimeout(()=>{document.body.contains(n)&&document.body.removeChild(n)},500))},3e3)}window.addEventListener("online",()=>{if(console.log("ç½‘ç»œè¿æ¥å·²æ¢å¤"),document.getElementById("errorState").style.display==="block"){const e=document.createElement("div");e.className="fixed top-4 left-4 right-4 bg-green-600 text-white p-3 rounded-lg z-50",e.innerHTML="ğŸŒ ç½‘ç»œè¿æ¥å·²æ¢å¤ï¼Œå¯ä»¥é‡æ–°åŠ è½½æ¸¸æˆ",document.body.appendChild(e),setTimeout(()=>{document.body.removeChild(e)},3e3)}});window.addEventListener("offline",()=>{console.log("ç½‘ç»œè¿æ¥å·²æ–­å¼€");const e=document.createElement("div");e.className="fixed top-4 left-4 right-4 bg-red-600 text-white p-3 rounded-lg z-50",e.innerHTML="âš ï¸ ç½‘ç»œè¿æ¥å·²æ–­å¼€ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨",document.body.appendChild(e),setTimeout(()=>{document.body.contains(e)&&document.body.removeChild(e)},5e3)});(async function(){try{console.log("ğŸš€ å¼€å§‹åˆå§‹åŒ–æ¸¸æˆæ¨¡å—...");let t=null,o=null;try{t=await x(()=>import("./offline-fallback-CiPykxTm.js"),__vite__mapDeps([0,1])),console.log("âœ… ç¦»çº¿æ¨¡å—åŠ è½½æˆåŠŸ")}catch(a){throw console.error("âŒ ç¦»çº¿æ¨¡å—åŠ è½½å¤±è´¥:",a.message),new Error("ç¦»çº¿æ¨¡å—æ˜¯å¿…éœ€çš„ï¼Œåˆå§‹åŒ–å¤±è´¥")}try{o=await x(()=>import("./analytics-CZ3OqPXu.js"),__vite__mapDeps([2,1])),window.trackEvent=o.trackEvent,console.log("âœ… Analyticsæ¨¡å—åŠ è½½æˆåŠŸ")}catch(a){console.warn("âš ï¸ Analyticsæ¨¡å—åŠ è½½å¤±è´¥:",a.message),window.trackEvent=function(n,s){console.log("ğŸ“Š Analyticsç¦»çº¿æ¨¡å¼:",n,s)}}w=t.hybridGetGameCardIds,h=t.hybridGetCardById,v=t.hybridGetGameData,console.log("âœ… æ··åˆæ¨¡å¼æ¨¡å—è®¾ç½®æˆåŠŸ"),navigator.onLine?console.log("ğŸŒ ç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œå°†ä¼˜å…ˆä½¿ç”¨åœ¨çº¿æ•°æ®"):(console.log("ğŸ”Œ æ£€æµ‹åˆ°ç¦»çº¿çŠ¶æ€ï¼Œå°†ä½¿ç”¨ç¦»çº¿æ•°æ®"),C&&C("offline")),await L()}catch(t){console.error("âŒ åˆå§‹åŒ–å¤±è´¥:",t.message);try{if(console.log("ğŸ”Œ å°è¯•çº¯ç¦»çº¿æ¨¡å¼..."),typeof fallbackCards<"u"){console.log("âœ… æ£€æµ‹åˆ°fallbackæ•°æ®ï¼Œä½¿ç”¨çº¯ç¦»çº¿æ¨¡å¼"),w=function(o,a){return Promise.resolve(getOfflineCardIds?getOfflineCardIds(a):[])},h=function(o){return Promise.resolve(getOfflineCardById?getOfflineCardById(o):null)},v=function(o){return Promise.resolve(fallbackGameData||null)},window.trackEvent=function(o,a){console.log("ğŸ“Š Analyticså®Œå…¨ç¦»çº¿æ¨¡å¼:",o,a)},await L(),console.log("âœ… çº¯ç¦»çº¿æ¨¡å¼å¯åŠ¨æˆåŠŸ");return}throw new Error("æ— å¯ç”¨çš„ç¦»çº¿æ•°æ®")}catch(o){console.error("âŒ æ‰€æœ‰åˆå§‹åŒ–å°è¯•éƒ½å¤±è´¥:",o.message),document.getElementById("loadingState").style.display="none",document.getElementById("errorState").style.display="block",document.getElementById("errorState").innerHTML=`
              <div class="text-center py-8">
                <p class="mb-4 text-lg">ğŸš« åˆå§‹åŒ–å¤±è´¥</p>
                <p class="text-sm text-gray-400 mb-2">åŸå› : ${t.message}</p>
                <p class="text-sm text-gray-400 mb-6">æ‰€æœ‰å¯åŠ¨æ–¹å¼éƒ½å¤±è´¥äº†</p>
                <div class="space-y-3">
                  <button onclick="location.reload()" class="bg-red-500 text-white px-6 py-2 rounded-lg block w-full">é‡æ–°åŠ è½½</button>
                  <button onclick="window.history.back()" class="bg-gray-600 text-white px-6 py-2 rounded-lg block w-full">è¿”å›æ¸¸æˆåº“</button>
                </div>
              </div>
            `}}})();function $(e){r[e]&&(b[e]=[...r[e]],E[e]=[],c[e]=0)}function M(){const e=document.querySelector(`.stacked-card[data-category='${i[0]}']`);i.push(i.shift()),l=i[0],i.forEach((t,o)=>{const a=document.querySelector(`.stacked-card[data-category='${t}']`);if(a)if(a.classList.remove("slide-out-up","slide-out-down","slide-out-left","slide-out-right"),o===0)a.style.transform="translateY(0px) scale(1)",a.style.zIndex=10,a.style.opacity="1",a.style.pointerEvents="auto";else{const n=o*10,s=o*-45,u=1-o*.04;a.style.transform=`translate(${n}px, ${s}px) scale(${u})`,a.style.zIndex=10-o,a.style.opacity="1",a.style.pointerEvents="none"}}),e&&(e.style.display="none",setTimeout(()=>{e.style.display==="none"&&(e.style.display="block",e.style.opacity="1")},100)),g=!1}function p(e){if(g)return;g=!0;const t=document.querySelector(`.stacked-card[data-category='${i[0]}']`);if(!t){g=!1;return}t.classList.add(`slide-out-${e}`),t.addEventListener("animationend",M,{once:!0})}function B(){l=i[0];const e=document.querySelector(`.stacked-card[data-category='${l}']`);if(!e)return;const t=e.querySelector(".topic-text");T||(t.classList.remove("topic-fade-in"),t.classList.add("topic-fade-out"),setTimeout(()=>{t.textContent="ç‚¹å‡»å¡ç‰‡å¼€å§‹",t.classList.remove("topic-fade-out"),t.classList.add("topic-fade-in")},300))}async function _(e){if(!r[e]||r[e].length===0||(c[e]===void 0&&(c[e]=0),c[e]>=r[e].length))return null;const t=r[e][c[e]];c[e]++;try{return await h(t)}catch(o){return console.error("Error fetching card by ID:",o),null}}async function k(){if(d)return;if(d=!0,T=!0,!r[l]){const o=document.querySelector(`.stacked-card[data-category='${l}']`);if(o){const a=o.querySelector(".topic-text");a.textContent="è¯é¢˜æ•°æ®æœªåŠ è½½æˆ–ç±»å‹ä¸å­˜åœ¨ã€‚"}d=!1;return}const e=document.querySelector(`.stacked-card[data-category='${l}']`);if(!e){d=!1;return}const t=e.querySelector(".topic-text");t.classList.remove("topic-fade-in"),t.classList.add("topic-fade-out"),setTimeout(async()=>{try{const o=await _(l);if(o===null){O(),d=!1;return}window.trackEvent&&window.trackEvent("TOPIC_DRAW",{category:l}),t.textContent=o.content,t.classList.remove("topic-fade-out"),t.classList.add("topic-fade-in"),setTimeout(()=>{d=!1},600)}catch(o){console.error("Error displaying new topic:",o),t.textContent="åŠ è½½è¯é¢˜å¤±è´¥ï¼Œè¯·é‡è¯•",t.classList.remove("topic-fade-out"),t.classList.add("topic-fade-in"),setTimeout(()=>{d=!1},600)}},300)}function O(){const e=document.getElementById("completionModal"),t=document.getElementById("completedCount"),o=document.getElementById("currentCategoryName");t.textContent=r[l].length,o.textContent=S[l],window.trackEvent&&window.trackEvent("CATEGORY_COMPLETE",{category:l}),e.classList.add("active"),document.body.style.overflow="hidden"}window.closeCompletionModal=function(){document.getElementById("completionModal").classList.remove("active"),document.body.style.overflow=""};window.restartCategory=function(){window.trackEvent&&window.trackEvent("CATEGORY_RESTART",{category:l}),$(l),closeCompletionModal();const e=document.querySelector(`.stacked-card[data-category='${l}']`);if(e){const t=e.querySelector(".topic-text");t.classList.remove("topic-fade-in"),t.classList.add("topic-fade-out"),setTimeout(()=>{t.textContent="ç‚¹å‡»ç»§ç»­æ–°ä¸€è½®",t.classList.remove("topic-fade-out"),t.classList.add("topic-fade-in")},300)}};document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".card-stack");if(!e)return;let t=0,o=0,a=!1;e.addEventListener("mousedown",n=>{n.target.closest(".stacked-card")===document.querySelector(`.stacked-card[data-category='${i[0]}']`)&&(t=n.clientX,o=n.clientY,a=!0)}),e.addEventListener("mousemove",n=>{a&&n.preventDefault()}),e.addEventListener("mouseup",n=>{if(!a)return;a=!1;const s=n.clientX-t,u=n.clientY-o;Math.abs(s)>50||Math.abs(u)>50?p("next"):k()}),e.addEventListener("touchstart",n=>{n.target.closest(".stacked-card")===document.querySelector(`.stacked-card[data-category='${i[0]}']`)&&(t=n.touches[0].clientX,o=n.touches[0].clientY,a=!0)}),e.addEventListener("touchend",n=>{if(!a)return;a=!1;const s=n.changedTouches[0].clientX,u=n.changedTouches[0].clientY,m=s-t,y=u-o;if(Math.abs(m)<50&&Math.abs(y)<50){k();return}Math.abs(m)>Math.abs(y)?p(m>0?"right":"left"):p(y>0?"down":"up")})});window.goBack=function(){window.location.href="index.html"};document.getElementById("completionModal").addEventListener("click",function(e){e.target===this&&closeCompletionModal()});document.addEventListener("keydown",function(e){e.key==="Escape"&&closeCompletionModal()});function q(){if(!navigator.onLine)throw new Error("ç½‘ç»œè¿æ¥å·²æ–­å¼€ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•");if(navigator.connection){const e=navigator.connection;(e.effectiveType==="slow-2g"||e.effectiveType==="2g")&&console.warn("æ£€æµ‹åˆ°æ…¢é€Ÿç½‘ç»œè¿æ¥ï¼Œå¯èƒ½éœ€è¦æ›´é•¿åŠ è½½æ—¶é—´")}}async function L(){try{q(),console.log("Loading game data from database...");const e=performance.now();if(console.log("ğŸ”„ æ­£åœ¨è·å–æ¸¸æˆæ•°æ®..."),f=await v("drinking-topics"),!f)throw new Error("Game not found with category_tag: drinking-topics");console.log("Game data loaded:",f);const t=Object.keys(S).map(async n=>{console.log(`Loading card IDs for category: ${n}`);try{console.log(`ğŸ”„ æ­£åœ¨åŠ è½½ ${n} åˆ†ç±»çš„å¡ç‰‡...`);const s=await w(f.id,n);return console.log(`âœ… æˆåŠŸåŠ è½½ ${s.length} å¼  ${n} å¡ç‰‡`),r[n]=s,b[n]=[...s],E[n]=[],c[n]=0,{categoryId:n,count:s.length}}catch(s){return console.warn(`Failed to load cards for ${n}:`,s),r[n]=[],b[n]=[],E[n]=[],c[n]=0,{categoryId:n,count:0}}}),o=await Promise.all(t),a=performance.now()-e;console.log(`All card IDs loaded in ${a.toFixed(2)}ms:`,o),document.getElementById("loadingState").style.display="none",document.getElementById("gameContainer").style.display="flex",M(),B()}catch(e){console.error("Error loading game data:",e),document.getElementById("loadingState").style.display="none",document.getElementById("errorState").style.display="block";let t=e.message,o="";e.message.includes("timeout")||e.message.includes("è¶…æ—¶")?o=`
              <div class="mt-4 p-3 bg-yellow-900/20 border border-yellow-500/30 rounded-lg">
                <p class="text-yellow-400 text-sm mb-2">ğŸ’¡ ç½‘ç»œè¿æ¥å»ºè®®ï¼š</p>
                <ul class="text-gray-300 text-xs space-y-1">
                  <li>â€¢ å°è¯•åˆ‡æ¢åˆ°æ›´ç¨³å®šçš„WiFiç½‘ç»œ</li>
                  <li>â€¢ å¦‚ä½¿ç”¨ç§»åŠ¨æ•°æ®ï¼Œè¯·ç¡®ä¿ä¿¡å·è‰¯å¥½</li>
                  <li>â€¢ ç¨ç­‰ç‰‡åˆ»åé‡è¯•ï¼ŒæœåŠ¡å™¨å¯èƒ½æš‚æ—¶ç¹å¿™</li>
                </ul>
              </div>
            `:e.message.includes("ç½‘ç»œè¿æ¥å·²æ–­å¼€")&&(o=`
              <div class="mt-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg">
                <p class="text-red-400 text-sm mb-2">ğŸ”Œ è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</p>
                <ul class="text-gray-300 text-xs space-y-1">
                  <li>â€¢ ç¡®ä¿è®¾å¤‡å·²è¿æ¥åˆ°äº’è”ç½‘</li>
                  <li>â€¢ å°è¯•æ‰“å¼€å…¶ä»–ç½‘é¡µç¡®è®¤ç½‘ç»œæ­£å¸¸</li>
                </ul>
              </div>
            `),document.getElementById("errorState").innerHTML=`
            <div class="text-center">
              <p class="mb-4 text-lg">ğŸ˜• åŠ è½½æ¸¸æˆæ•°æ®å¤±è´¥</p>
              <p class="text-sm text-gray-400 mb-4">é”™è¯¯è¯¦æƒ…: ${t}</p>
              ${o}
              <div class="mt-6 space-y-3">
                <button onclick="location.reload()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg transition-colors w-full">
                  ğŸ”„ é‡æ–°åŠ è½½
                </button>
                <button onclick="window.location.href='index.html'" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg transition-colors w-full">
                  â¬…ï¸ è¿”å›æ¸¸æˆåº“
                </button>
              </div>
            </div>
          `}}
